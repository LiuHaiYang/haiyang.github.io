<!DOCTYPE HTML>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
    <!--Setting-->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta name="renderer" content="webkit|ie-comp|ie-stand">
    <meta name="apple-mobile-web-app-capable" content="meet you">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no,email=no,adress=no">
    <meta name="browsermode" content="application">
    <meta name="screen-orientation" content="portrait">
    <link rel="dns-prefetch" href="http://yoursite.com">
    <!--SEO-->





<meta name="robots" content="all">
<meta name="google" content="all">
<meta name="googlebot" content="all">
<meta name="verify" content="all">
    <!--Title-->


<title>用Netty写一个高性能的分布式服务框架？ | meet you</title>


    <link rel="alternate" href="/atom.xml" title="meet you" type="application/atom+xml">


    <link rel="icon" href="/img/favicon.ico">

    


    <link rel="stylesheet" href="//imsun.github.io/gitment/style/default.css">


<link rel="stylesheet" href="/css/bootstrap.min.css?rev=3.3.7">
<link rel="stylesheet" href="/css/font-awesome.min.css?rev=4.5.0">
<link rel="stylesheet" href="/css/style.css?rev=@@hash">




    


    

</head>

</html>
<!--[if lte IE 8]>
<style>
    html{ font-size: 1em }
</style>
<![endif]-->
<!--[if lte IE 9]>
<div style="ie">你使用的浏览器版本过低，为了你更好的阅读体验，请更新浏览器的版本或者使用其他现代浏览器，比如Chrome、Firefox、Safari等。</div>
<![endif]-->

<body>
    <header class="main-header"  style="background-image:url(http://snippet.shenliyang.com/img/banner.jpg)"  >
    <div class="main-header-box">
        <a class="header-avatar" href="/" title='Ocean'>
            <img src="/img/avatar.jpg" alt="logo头像" class="img-responsive center-block">
        </a>
        <div class="branding">
        	<!--<h2 class="text-hide">Snippet主题,从未如此简单有趣</h2>-->
            
                <h2> Always believe youself. </h2>
            
    	</div>
    </div>
</header>
    <nav class="main-navigation">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <div class="navbar-header"><span class="nav-toggle-button collapsed pull-right" data-toggle="collapse" data-target="#main-menu" id="mnav">
                    <span class="sr-only"></span>
                        <i class="fa fa-bars"></i>
                    </span>
                    <a class="navbar-brand" href="http://yoursite.com">meet you</a>
                </div>
                <div class="collapse navbar-collapse" id="main-menu">
                    <ul class="menu">
                        
                            <li role="presentation" class="text-center">
                                <a href="/"><i class="fa "></i>首页</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/python/"><i class="fa "></i>python</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/java/"><i class="fa "></i>JAVA</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/tags/生活/"><i class="fa "></i>生活</a>
                            </li>
                        
                            <li role="presentation" class="text-center">
                                <a href="/archives/"><i class="fa "></i>时间轴</a>
                            </li>
                        
                    </ul>
                </div>
            </div>
        </div>
    </div>
</nav>
    <section class="content-wrap">
        <div class="container">
            <div class="row">
                <main class="col-md-8 main-content m-post">
                    <p id="process"></p>
<article class="post">
    <div class="post-head">
        <h1 id="用Netty写一个高性能的分布式服务框架？">
            
	            用Netty写一个高性能的分布式服务框架？
            
        </h1>
        <div class="post-meta">
    
    
    <span class="categories-meta fa-wrap">
        <i class="fa fa-folder-open-o"></i>
        <a href="/categories/ ">
             
        </a>
    </span>
    
    
    <span class="fa-wrap">
        <i class="fa fa-tags"></i>
        <span class="tags-meta">
            
                
                    <a href="/tags/java" title='java'>
                        java
                    </a>
                
            
        </span>
    </span>
    

    
        
        <span class="fa-wrap">
            <i class="fa fa-clock-o"></i>
            <span class="date-meta">2021/07/06</span>
        </span>
    
</div>

            
            
    </div>
    
    <div class="post-body post-content">
        <h2 id="什么是-Netty-能做什么"><a href="#什么是-Netty-能做什么" class="headerlink" title="什么是 Netty? 能做什么?"></a>什么是 Netty? 能做什么?</h2><ul>
<li>Netty 是一个致力于创建高性能网络应用程序的成熟的 IO 框架。</li>
<li>相比较与直接使用底层的 Java IO API，你不需要先成为网络专家就可以基于 Netty 去构建复杂的网络应用。</li>
<li>业界常见的涉及到网络通信的相关中间件大部分基于 Netty 实现网络层。</li>
</ul>
<h2 id="设计一个分布式服务框架"><a href="#设计一个分布式服务框架" class="headerlink" title="设计一个分布式服务框架"></a>设计一个分布式服务框架</h2><h3 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/Z6bicxIx5naIohPtQJfcNCrXMkbmXiaia6LDoz4PxKXAkneiaF6DQllZdavgWmIfL4ibQ8GOicrVfhHia4IEKKIAE7b1A/640?wx_fmt=jpeg&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="远程调用的流程"><a href="#远程调用的流程" class="headerlink" title="远程调用的流程"></a>远程调用的流程</h3><ul>
<li><p>启动服务端(服务提供者)并发布服务到注册中心。</p>
</li>
<li><p>启动客户端(服务消费者)并去注册中心订阅感兴趣的服务。</p>
</li>
<li><p>客户端收到注册中心推送的服务地址列表。</p>
</li>
<li><p>调用者发起调用，Proxy从服务地址列表中选择一个地址并将请求信息 &lt;group，providerName，version&gt;，methodName，args[] 等信息序列化为字节数组并通过网络发送到该地址上。</p>
</li>
<li><p>服务端收到收到并反序列化请求信息，根据 &lt;group，providerName，version&gt; 从本地服务字典里查找到对应providerObject，再根据 &lt;methodName，args[]&gt; 通过反射调用指定方法，并将方法返回值序列化为字节数组返回给客户端。</p>
</li>
<li><p>客户端收到响应信息再反序列化为 Java 对象后由 Proxy 返回给方法调用者。</p>
</li>
</ul>
<h3 id="远程调用客户端图解"><a href="#远程调用客户端图解" class="headerlink" title="远程调用客户端图解"></a>远程调用客户端图解</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVica9JuqItJJdRFYOY9PAWv78qEHLJegPoYaaAV2eWpXhBCWob0y07AA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<p>重要概念：RPC三元组 &lt;ID，Request，Response&gt;。</p>
<p>PS: 若是 netty4.x 的线程模型，IO Thread(worker) —&gt; Map&lt;InvokeId，Future&gt; 代替全局 Map 能更好的避免线程竞争。</p>
<h3 id="远程调用服务端图解"><a href="#远程调用服务端图解" class="headerlink" title="远程调用服务端图解"></a>远程调用服务端图解</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVNIibkTgLs38j4qiaKMy7SP7jSuTsGdCAdAtw3vWZ9RzNoiajno6I8mSdg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="远程调用传输层图解"><a href="#远程调用传输层图解" class="headerlink" title="远程调用传输层图解"></a>远程调用传输层图解</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVfw9p0aAGa4Uhl1LvdnRq0Q5UdyJPxoGw8A4FBeNcYseALBjzic0lEMA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="设计传输层协议栈"><a href="#设计传输层协议栈" class="headerlink" title="设计传输层协议栈"></a>设计传输层协议栈</h3><p>协议头</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVocV0LrE1TnUwLvVj4OWHNGq7icoanr82RDosyyoo1DlT5kzicB6muxEQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<p>协议体</p>
<ul>
<li><p>metadata: &lt;group，providerName，version&gt;</p>
</li>
<li><p>methodName</p>
</li>
<li><p>parameterTypes[] 真的需要吗?</p>
<ul>
<li><p>有什么问题?</p>
<p>  反序列化时 ClassLoader.loadClass() 潜在锁竞争。</p>
<p>  协议体码流大小。</p>
<p>  泛化调用多了参数类型。</p>
</li>
<li><p>能解决吗?</p>
<p>  Java方法静态分派规则参考JLS &lt;Java语言规范&gt; $15.12.2.5 Choosing the Most Specific Method 章节。</p>
</li>
<li><p>args[]</p>
</li>
<li><p>其他：traceId，appName…</p>
</li>
</ul>
</li>
</ul>
<h2 id="一些Features-amp-好的实践-amp-压榨性能"><a href="#一些Features-amp-好的实践-amp-压榨性能" class="headerlink" title="一些Features&amp;好的实践&amp;压榨性能"></a>一些Features&amp;好的实践&amp;压榨性能</h2><h3 id="创建客户端代理对象"><a href="#创建客户端代理对象" class="headerlink" title="创建客户端代理对象"></a>创建客户端代理对象</h3><p>1）Proxy 做什么?</p>
<pre><code>- 集群容错 —&gt; 负载均衡 —&gt; 网络
</code></pre><p>2）有哪些创建 Proxy 的方式?</p>
<pre><code>- jdk proxy/javassist/cglib/asm/bytebuddy
</code></pre><p>3）要注意的：</p>
<pre><code>- 注意拦截toString，equals，hashCode等方法避免远程调用。
</code></pre><p>4）推荐的(bytebuddy)：</p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVFbW4MLrOO1J077QV0oHScUJVWFeUZURSCedYRYTpd8n5Agnohico9ibA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="优雅的同步-异步调用"><a href="#优雅的同步-异步调用" class="headerlink" title="优雅的同步/异步调用"></a>优雅的同步/异步调用</h3><ul>
<li><p>先往上翻再看看“远程调用客户端图解”</p>
</li>
<li><p>再往下翻翻看看 Failover 如何处理更好</p>
</li>
<li><p>思考下如何拿到 future?</p>
</li>
</ul>
<h3 id="单播-组播"><a href="#单播-组播" class="headerlink" title="单播/组播"></a>单播/组播</h3><ul>
<li><p>消息派发器</p>
</li>
<li><p>FutureGroup</p>
</li>
</ul>
<h3 id="泛化调用"><a href="#泛化调用" class="headerlink" title="泛化调用"></a>泛化调用</h3><ul>
<li><p>Object $invoke(String methodName，Object… args)</p>
</li>
<li><p>parameterTypes[]</p>
</li>
</ul>
<h3 id="序列化-反序列化"><a href="#序列化-反序列化" class="headerlink" title="序列化/反序列化"></a>序列化/反序列化</h3><ul>
<li>协议 header 标记 serializer type，同时支持多种。</li>
</ul>
<h3 id="可扩展性"><a href="#可扩展性" class="headerlink" title="可扩展性"></a>可扩展性</h3><pre><code>Java SPI：

java.util.ServiceLoader

META-INF/services/com.xxx.Xxx
</code></pre><h3 id="服务级别线程池隔离"><a href="#服务级别线程池隔离" class="headerlink" title="服务级别线程池隔离"></a>服务级别线程池隔离</h3><ul>
<li>要挂你先挂，别拉着我。</li>
</ul>
<h3 id="责任链模式的拦截器"><a href="#责任链模式的拦截器" class="headerlink" title="责任链模式的拦截器"></a>责任链模式的拦截器</h3><ul>
<li>太多扩展需要从这里起步。</li>
</ul>
<h3 id="指标度量-Metrics"><a href="#指标度量-Metrics" class="headerlink" title="指标度量(Metrics)"></a>指标度量(Metrics)</h3><h3 id="链路追踪"><a href="#链路追踪" class="headerlink" title="链路追踪"></a>链路追踪</h3><ul>
<li>OpenTracing</li>
</ul>
<h3 id="注册中心"><a href="#注册中心" class="headerlink" title="注册中心"></a>注册中心</h3><h3 id="流控-应用级别-服务级别"><a href="#流控-应用级别-服务级别" class="headerlink" title="流控(应用级别/服务级别)"></a>流控(应用级别/服务级别)</h3><ul>
<li>要有能方便接入第三方流控中间件的扩展能力。</li>
</ul>
<h3 id="Provider线程池满了怎么办"><a href="#Provider线程池满了怎么办" class="headerlink" title="Provider线程池满了怎么办?"></a>Provider线程池满了怎么办?</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WV1QRsJFx3EJHkAVLgD2RYfhZnus2ZRnw2n5lG3uEviaEX7dwvHLz0b1g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="软负载均衡"><a href="#软负载均衡" class="headerlink" title="软负载均衡"></a>软负载均衡</h3><ul>
<li>加权随机 (二分法，不要遍历)</li>
</ul>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVlpzvm3Fc1hsWBwGK5roJTb4NVteWicr2RmSsiaceGFSKta3OseX1LW0g/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<ul>
<li><p>加权轮训(最大公约数)<br><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVHpjyojZ5LGvp2q5oLibQzGsxwJZWcMQo6TlCgKsMUrMDh447GBHaiazA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
</li>
<li><p>最小负载</p>
</li>
<li><p>一致性 hash (有状态服务场景)</p>
</li>
<li><p>其他</p>
</li>
</ul>
<p>注意：要有预热逻辑</p>
<h3 id="集群容错"><a href="#集群容错" class="headerlink" title="集群容错"></a>集群容错</h3><ul>
<li><p>Fail-fast</p>
</li>
<li><p>Failover</p>
</li>
<li><p>Fail-safe</p>
</li>
<li><p>Fail-back</p>
</li>
<li><p>Forking</p>
</li>
<li><p>其他</p>
</li>
</ul>
<h2 id="Why-Netty"><a href="#Why-Netty" class="headerlink" title="Why Netty?"></a>Why Netty?</h2><h3 id="BIO-vs-NIO"><a href="#BIO-vs-NIO" class="headerlink" title="BIO vs NIO"></a>BIO vs NIO</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVCiaN5pic0nGhUReIazjUMR8BTIxj7Zria55RMicX4k5QfxppZIoGbMB6jQ/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="Java-原生-NIO-API-从入门到放弃"><a href="#Java-原生-NIO-API-从入门到放弃" class="headerlink" title="Java 原生 NIO API 从入门到放弃"></a>Java 原生 NIO API 从入门到放弃</h3><ul>
<li>复杂度高</li>
<li>稳定性差，坑多且深</li>
<li>NIO 代码实现方面的一些缺点<ul>
<li>Selector.selectedKeys() 产生太多垃圾</li>
<li>fdToKey 映射</li>
<li>Selector在linux 平台是 Epoll LT 实现</li>
<li>Direct Buffers 事实上还是由 GC 管理</li>
</ul>
</li>
</ul>
<h2 id="Netty-的真实面目"><a href="#Netty-的真实面目" class="headerlink" title="Netty 的真实面目"></a>Netty 的真实面目</h2><h3 id="Netty-中几个重要概念及其关系"><a href="#Netty-中几个重要概念及其关系" class="headerlink" title="Netty 中几个重要概念及其关系"></a>Netty 中几个重要概念及其关系</h3><p>EventLoop</p>
<ul>
<li><p>一个 Selector。</p>
</li>
<li><p>一个任务队列(mpsc_queue: 多生产者单消费者 lock-free)。</p>
</li>
<li><p>一个延迟任务队列(delay_queue: 一个二叉堆结构的优先级队列，复杂度为O(log n))。</p>
</li>
<li><p>EventLoop 绑定了一个 Thread，这直接避免了pipeline 中的线程竞争。</p>
</li>
</ul>
<p>Boss: mainReactor 角色，Worker: subReactor 角色</p>
<ul>
<li><p>Boss 和 Worker 共用 EventLoop 的代码逻辑，Boss 处理 accept 事件，Worker 处理 read，write 等事件。</p>
</li>
<li><p>Boss 监听并 accept 连接(channel)后以轮训的方式将 channel 交给 Worker，Worker 负责处理此 channel 后续的read/write 等 IO 事件。</p>
</li>
<li><p>在不 bind 多端口的情况下 BossEventLoopGroup 中只需要包含一个 EventLoop，也只能用上一个，多了没用。</p>
</li>
<li><p>WorkerEventLoopGroup 中一般包含多个 EventLoop，经验值一般为 cpu cores * 2(根据场景测试找出最佳值才是王道)。</p>
</li>
<li><p>Channel 分两大类 ServerChannel 和 Channel，ServerChannel 对应着监听套接字(ServerSocketChannel)，Channel 对应着一个网络连接。</p>
</li>
</ul>
<h3 id="Netty4-Thread-Model"><a href="#Netty4-Thread-Model" class="headerlink" title="Netty4 Thread Model"></a>Netty4 Thread Model</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVE2LMs3iaPZdUopLoMPqQ45gOjhVeDcmcErvYe3AfW43vz3Mm0iczIocg/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="ChannelPipeline"><a href="#ChannelPipeline" class="headerlink" title="ChannelPipeline"></a>ChannelPipeline</h3><p><img src="https://mmbiz.qpic.cn/mmbiz_png/Z6bicxIx5naIz6YRIIkgjfgxxIKbGR5WVbnVhOE1fQcgzYcWCOTTib5xrmmqMoiawSUS1FRbAPMnZWMVDx1QxMmFA/640?wx_fmt=png&amp;tp=webp&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="image"></p>
<h3 id="Pooling-amp-reuse"><a href="#Pooling-amp-reuse" class="headerlink" title="Pooling&amp;reuse"></a>Pooling&amp;reuse</h3><ul>
<li><p>PooledByteBufAllocator</p>
<ul>
<li><p>基于 jemalloc paper (3.x)</p>
<ul>
<li>ThreadLocal caches for lock free：这个做法导致曾经有坑——申请(Bytebuf)线程与归还(Bytebuf)线程不是同一个导致内存泄漏，后来用一个mpsc_queue解决，代价就是牺牲了一点点性能。</li>
</ul>
</li>
<li><p>Different size classes。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>Recycler</p>
<ul>
<li><p>ThreadLocal + Stack。</p>
</li>
<li><p>曾经有坑，申请(元素)线程与归还(元素)线程不是同一个导致内存泄漏。</p>
</li>
<li><p>后来改进为不同线程归还元素的时候放入一个 WeakOrderQueue 中并关联到 stack 上，下次 pop 时如果 stack 为空则先扫描所有关联到当前 stack 上的 weakOrderQueue。</p>
</li>
<li><p>WeakOrderQueue 是多个数组的链表，每个数组默认size=16。</p>
</li>
<li><p>存在的问题：思考一下老年代对象引用新生代对象对 GC 的影响？</p>
</li>
</ul>
</li>
</ul>
<h3 id="Netty-Native-Transport"><a href="#Netty-Native-Transport" class="headerlink" title="Netty Native Transport"></a>Netty Native Transport</h3><h3 id="多路复用简介"><a href="#多路复用简介" class="headerlink" title="多路复用简介"></a>多路复用简介</h3><p>未完！！！</p>

    </div>

    <div class="post-footer">
        <div>
            
                转载声明：商业转载请联系作者获得授权,非商业转载请注明出处 ,图片资源转自pexels © <a href="" target="_blank">Ocean</a>
            
        </div>
        <div>
            
        </div>
    </div>
</article>

<div class="article-nav prev-next-wrap clearfix">
    
    
        <a href="/2021/07/06/IO演进之路/" class="next-post btn btn-default" title='IO演进之路'>
            <span class="hidden-lg">下一篇</span>
            <span class="hidden-xs">IO演进之路</span><i class="fa fa-angle-right fa-fw"></i>
        </a>
    
</div>


    <div id="comments">
        
	<link rel="stylesheet" href="https://jjeejj.github.io/css/gitment.css">
<script src="https://jjeejj.github.io/js/gitment.js"></script>

<script>
    var gitment = new Gitment({
        id: 'Tue Jul 06 2021 15:38:53 GMT+0800',
        owner:"LiuHaiYang",
        repo:"liuhaiyang.github.io",
        oauth: {
          client_id:"aacf4f5555aee5bf0770",
          client_secret:"07f91d5b66c30419c14d14349ccadaa91300bc9c"
        },
        perPage:"10",
    });
    gitment.render('comments');
</script>

    </div>





                </main>
                
                    <aside id="article-toc" role="navigation" class="col-md-4">
    <div class="widget">
        <h3 class="title">文章目录</h3>
        
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#什么是-Netty-能做什么"><span class="toc-text">什么是 Netty? 能做什么?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#设计一个分布式服务框架"><span class="toc-text">设计一个分布式服务框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Architecture"><span class="toc-text">Architecture</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程调用的流程"><span class="toc-text">远程调用的流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程调用客户端图解"><span class="toc-text">远程调用客户端图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程调用服务端图解"><span class="toc-text">远程调用服务端图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#远程调用传输层图解"><span class="toc-text">远程调用传输层图解</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设计传输层协议栈"><span class="toc-text">设计传输层协议栈</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一些Features-amp-好的实践-amp-压榨性能"><span class="toc-text">一些Features&amp;好的实践&amp;压榨性能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建客户端代理对象"><span class="toc-text">创建客户端代理对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#优雅的同步-异步调用"><span class="toc-text">优雅的同步/异步调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#单播-组播"><span class="toc-text">单播/组播</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#泛化调用"><span class="toc-text">泛化调用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#序列化-反序列化"><span class="toc-text">序列化/反序列化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#可扩展性"><span class="toc-text">可扩展性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#服务级别线程池隔离"><span class="toc-text">服务级别线程池隔离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#责任链模式的拦截器"><span class="toc-text">责任链模式的拦截器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指标度量-Metrics"><span class="toc-text">指标度量(Metrics)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链路追踪"><span class="toc-text">链路追踪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注册中心"><span class="toc-text">注册中心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流控-应用级别-服务级别"><span class="toc-text">流控(应用级别/服务级别)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Provider线程池满了怎么办"><span class="toc-text">Provider线程池满了怎么办?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#软负载均衡"><span class="toc-text">软负载均衡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#集群容错"><span class="toc-text">集群容错</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Why-Netty"><span class="toc-text">Why Netty?</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BIO-vs-NIO"><span class="toc-text">BIO vs NIO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-原生-NIO-API-从入门到放弃"><span class="toc-text">Java 原生 NIO API 从入门到放弃</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Netty-的真实面目"><span class="toc-text">Netty 的真实面目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty-中几个重要概念及其关系"><span class="toc-text">Netty 中几个重要概念及其关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty4-Thread-Model"><span class="toc-text">Netty4 Thread Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ChannelPipeline"><span class="toc-text">ChannelPipeline</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pooling-amp-reuse"><span class="toc-text">Pooling&amp;reuse</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Netty-Native-Transport"><span class="toc-text">Netty Native Transport</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#多路复用简介"><span class="toc-text">多路复用简介</span></a></li></ol></li></ol>
        
    </div>
</aside>

                
            </div>
        </div>
    </section>
    <footer class="main-footer">
    <div class="container">
        <div class="row">
        </div>
    </div>
</footer>

<a id="back-to-top" class="icon-btn hide">
	<i class="fa fa-chevron-up"></i>
</a>




    <div class="copyright">
    <div class="container">
        <div class="row">
            <div class="col-sm-12"> 
                <span>Copyright &copy; 2019
                </span> | 
                <span>
                    Powered by <a href="//hexo.io" class="copyright-links" target="_blank" rel="nofollow">Ocean</a>
                </span> | 
                <span>
                    Theme by <a href="//github.com/shenliyang/hexo-theme-snippet.git" class="copyright-links" target="_blank" rel="nofollow">Snippet</a>
                </span>
            </div>
        </div>
    </div>
</div>



<script src="/js/app.js?rev=@@hash"></script>


</body>
</html>